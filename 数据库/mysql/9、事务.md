事务是一组SQL语句的集合，这些操作 _要什么同时成功，要么同时失败_ ，例如转账。![[Pasted image 20241119224048.png]]
MYSQL的事务是自动提交的，一个SQL语句就可以理解为一个事务
当对表中的数据进行操作时，用`SELECT`语句可以查看到变化，如果没有`commit`变化可以使用`ROLLBACK`撤销，如果使用了`COMMIT`变化就不能 撤销了。

### 查看/设置事务提交方式
```
SELECT @@autocommit;
SET @@autocommit = 0;
```

### 开启事务
```
START TRANSACTION;
```
### 提交事务
```
COMMIT;
```

### 回滚事务
```
ROLLBACK;
```

### 事务四大特性
1. 原子性：不可分割的最小操作
2. 一致性：事务执行前后，数据库状态保持一致
3. 隔离性：并发事务互不干扰
4. 持久性：事务提交后，数据永久保存

### 并发事务引发的问题
1. 脏读：读取数据后，数据被撤销（读到没有实际写到磁盘的数据）
2. 不可重复性： T1读取数据，T2修改数据，T1再读，读取同一个数据，前后不一
3. 丢失修改：同时提交，提交覆盖，前面调教消失
4. 幻读：相同的查询，不同的结果，第一次6条，第二次7条

### 事务的隔离级别
![[Pasted image 20241127155453.png]]
#### 查看事务隔离级别
```
SET @@TRANSACTION_ISOLATION;
```
1. 串行化隔离级别：只有一个客户端执行提交，另一个客户端的命令才会运行。同时只可以一个客户端执行。
#### 设置事务的隔离级别
```
SET [SESSION | GLOBAL] TRANSCATION ISOLATION LEVEL [xxxx]
```
1. 会话的概念：每一次客户端连接服务器，就是一次会话
2. 会话级别：当前会话
3. 全局：影响新会话，现有会话不受影响
